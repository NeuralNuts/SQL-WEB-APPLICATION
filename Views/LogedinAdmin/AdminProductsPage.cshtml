@{
    ViewData["Title"] = "AdminProductsPage";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<head>
    <link rel="stylesheet" type="text/css" href="/css/products.css" />
</head>

<body>
    <section>
        <div class="first-div">
            <div class="get-div">
                <h2>products</h2>
                <table>
                    <tr id="table-info">
                        <th>Id</th>
                        <th>Name</th>
                        <th>Price</th>
                        <th>Description</th>
                        <th>Updated date</th>
                    </tr>

                    <tbody id="product-table">

                    </tbody>

                </table>
            </div>
        </div>

        <div class="first-div">
            <div class="get-div">
                <h2>All Comments</h2>
                <table>
                    <tr id="table-info">
                        <th>Id</th>
                        <th>User</th>
                        <th>Product</th>
                        <th>Commnet</th>
                    </tr>

                    <tbody id="all-comments-table">

                    </tbody>

                </table>
            </div>
        </div>

        <div class="first-div">
            <div class="get-div">
                <h2 id="user-heading">all users</h2>
                <table>
                    <tr id="table-info">
                        <th>Id</th>
                        <th>Email</th>
                        <th>Password</th>
                    </tr>

                    <tbody id="users-table">

                    </tbody>

                </table>
            </div>
        </div>
    </section>
    <script>

        var productArray = []
        var userArray = []
        var commentArray = []

        /*Builds a table that displays all products,
        and if a new product is created the table
        will generate a new row*/

        function buildProductTabel(data) {
            var table = document.getElementById('product-table')

            for (var i = 0; i < data.length; i++) {
                var buttons = `<button>delete</button>`

                var row = `<tr>
                                <td>${data[i].product_id}</td>
                                <td>${data[i].product_name}</td>
                                <td>${data[i].product_price}$</td>
                                <td>${data[i].product_description}</td>
                                <td>${data[i].updated_date}</td>
                                <td class="td-button">${buttons}</td>
                            </tr>`
                table.innerHTML += row
            }
        }

        /*Builds a table that displays all comments,
        and if a new product is created the table
        will generate a new row*/

        function buildAllCommentsTabel(data) {
            var table = document.getElementById('all-comments-table')

            for (var i = 0; i < data.length; i++) {
                var buttons = `<button>delete</button>`

                var row = `<tr>
                                <td>${data[i].comment_id}</td>
                                <td>${data[i].email}</td>
                                <td>${data[i].fk_product_id}</td>
                                <td>${data[i].comment_text}</td>
                                <td class="td-button">${buttons}</td>
                           </tr>`
                table.innerHTML += row
            }
        }

        /*Builds a table that displays all users,
        and if a new product is created the table
        will generate a new row*/

        function buildUsersTabel(data) {
            var table = document.getElementById('users-table')

            for (var i = 0; i < data.length; i++) {
                var buttons = `<button>delete</button>`

                var row = `<tr>
                                <td>${data[i].user_id}</td>
                                <td>${data[i].email}</td>
                                <td>${data[i].password}</td>
                                <td class="td-button">${buttons}</td>
                           </tr>`
                table.innerHTML += row
            }
        }

        /*Gets all prodcuts via an ajax GET request 
        linked to the product controller*/

        $.ajax({
            type: "GET",
            url: "@Url.Action("GetProducts", "Product")",
            dataType: "JSON",
            success: function (response) {
                productArray = response
                buildProductTabel(productArray)
                console.log(productArray)
            }
        })

        /*Gets all users via an ajax GET request
        linked to the product controller*/
        $.ajax({
            type: "GET",
            url: "@Url.Action("GetAllUsers", "User")",
            dataType: "JSON",
            success: function (response) {
                userArray = response
                buildUsersTabel(userArray)
                console.log(userArray)
            }
        })

        /*Gets all comments via an ajax GET request 
        linked to the product controller*/

        $.ajax({
            type: "GET",
            url: "@Url.Action("GetComments", "Comment")",
            dataType: "JSON",
            success: function (response) {
                commentArray = response
                buildAllCommentsTabel(commentArray)
                console.log(commentArray)
            }
        })
    </script>
</body>